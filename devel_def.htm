<html>
    
<head>

	<script src="http://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>

	<!-- Latest compiled and minified CSS -->
	<link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">

	<!-- Optional theme -->
	<link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap-theme.min.css">

	<!-- Latest compiled and minified JavaScript -->
	<script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>

<meta name="viewport" content="width=device-width, initial-scale=1">


<script src="http://code.highcharts.com/highcharts.js"></script>
<script src="http://code.highcharts.com/highcharts-more.js"></script>
<script src="http://code.highcharts.com/modules/exporting.js"></script>

    <script type="text/javascript">


        $(document).ready(function() {
            //TestDownload();
            
        var start = 0;
        var end = 0;
        var binfile = '';
        var sum = 0;
        var download_records = [];
        var upload_records = [];

			function calc_average(records) {
				var sum = 0;
				for (i = 0; i < records.length; i++) {
    				sum = sum + records[i];
				}
				return Math.round((sum/records.length)*100)/100;
			}      
        
        var sources = ['256.jpg',
        					  '256.jpg',
        					  '512.jpg'
        					 ];

		 function Start() {

		 	sum = 0;
		 	$('.progress-bar-striped').addClass('active');
		 	$('#dlspeed').removeClass('hidden');
		 	TestDownloadNew(0);
		 }

		var host_maps = [ "http://us.testinternetspeed.link/",
							   ""
							 ];
		var ping_sources = ["http://us.testinternetspeed.link/ping.html",
								  "http://de.testinternetspeed.link/ping.php"
								 ];
		var server_loc = ['USA', 'Germany'];
		var ping_result = [0,0];
		var max_pos = 0;
		
		function PingTest(pos) {
						
		            start = new Date().getTime();
		            
		            $.ajax({
		                type: "GET",
		                url: ping_sources[pos],                
 
		                success: function(msg) {

								  var msg_r = "<strong>PING RESULT FOR "+server_loc[pos]+" SERVER FAILED!</strong><br>";
		                   
		                    if(msg.indexOf("OK")!=-1)
		                    {
		                    		end = new Date().getTime();
		                    		speed = (end - start) / 1000;
		                    		ping_result[pos] = speed;
		                    		if (ping_result[pos]<ping_result[max_pos]) {
		                    			max_pos = pos;
		                    		}
		                    		msg_r = "<h6>PING RESULT FOR <strong>"+server_loc[pos]+"</strong> TOOK <strong>"+String(speed)+"</strong> SECONDS</h6>";	
		                    }
		                    
		                    $('#ping_info').append(msg_r);
		                },
		                complete: function(xhr, textStatus) {
		                    
		                    if ( pos+1 < ping_sources.length  ) {
		                    		PingTest(pos+1);
		                    }else {
		                    		
		                    		$('#ping_info').append("Ping Test Completed! Using fast server: "+server_loc[max_pos]);
		                    		play_init();
		                    		Start();      		
		                    }

		                }
		            });
		        }        



		
		function TestDownloadNew(pos) {
		
						if (pos>sources.length) {
							return;
						}
						
		            start = new Date().getTime();
		            
		            $.ajax({

							  //PROGRESS INFO ++++
							  cache: false,
							  xhr: function()
							  {
							    var xhr = new window.XMLHttpRequest();
							    //Download progress
							    xhr.addEventListener("progress", function(evt){
							      if (evt.lengthComputable) {
							        var percentComplete = evt.loaded / evt.total;
							        //Do something with download progress
					              end = new Date().getTime();
		                       diff = (end - start) / 1000;
		                    	  speed = (evt.loaded / diff) / 1024 / 1024 * 8;
		                       speed = Math.round(speed*100)/100;
									  update_chart(speed, true);
							        download_records.push(speed); 
							      }
							    }, false);
							    return xhr;
							  },
							  contentType: false,
							  processData: false,
							  //PROGRESS INFO ----	            
		            
		            
		                type: "GET",
		                url: host_maps[max_pos] + sources[pos] + "?id=" + start,
		                success: function(msg) {
		                    binfile = msg;
		                },
		                complete: function(xhr, textStatus) {
		                    
		                    if ( pos+1 < sources.length  ) {
		                    		TestDownloadNew(pos+1);
		                    }else {
		                    		
		 								$('#dlspeed').html('<b> Download average speed: ' + calc_average(download_records) + ' Mb/s </b>');
		 								download_records = [];		   					   							
		   							play_init();
		   							TestUpload();
		   							
		   							ping_result = [0,0];
										max_pos = 0;
		                    }

		                }
		            });
		        }        

        
        function TestUpload() {
            start = new Date().getTime();
				speed = 0;            
            $.ajax({

					  //PROGRESS INFO ++++
					  cache: false,
					  xhr: function()
					  {
					    var xhr = new window.XMLHttpRequest();
					    //Upload progress
					    xhr.upload.addEventListener("progress", function(evt){
					      if (evt.lengthComputable) {
					        var percentComplete = evt.loaded / evt.total;
					        //Do something with download progress
			              end = new Date().getTime();
                       diff = (end - start) / 1000;         
                    	  speed = (evt.loaded / diff) / 1024 / 1024 * 8;
                       speed = Math.round(speed*100)/100;
							  update_chart(speed, false);
							  upload_records.push(speed);
					      }
					    }, false);
					    return xhr;
					  },
					  contentType: false,
					  processData: false,
					  //PROGRESS INFO ----

                type: "POST",
                url: host_maps[max_pos] + "post.php?id=" + start,
                data: binfile,
                success: function(msg) {

                    $('#ulspeed').html('<b> Upload average speed:' + calc_average(upload_records) + ' Mb/s </b>');
                    upload_records = [];
						  $('#start_test').removeClass('hidden');
                    play_stop();
                }
            });
        }
        
            $('#start_test').click(
					function () {
						$('#start_test').addClass('hidden');						
						$("#ping_info").html("<hr><h3>Ping Info:</h3>");
						PingTest(0);
						//Start();	
					});


function play_init() {
		
		document.getElementById('start_sound').play();
		
		var sound_r = document.getElementById('run_sound');
		sound_r.play();
		sound_r.loop = true;
	}
	
function play_stop() {
		var sound_r = document.getElementById('run_sound');
		sound_r.loop = false;
		sound_r.pause();
	}
	
        });


    </script>

<style>
	
	.bs-example{
			width: 300px;
	}

	.hidden{ display: none; }

</style>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-53022084-2', 'auto');
  ga('send', 'pageview');

</script>

<title> Test Internet Speed</title>

</head>     

<body>



<div class="container-fluid" id="starttest" >

<h1>Test Internet Speed Free!</h1>

<div class="row">


<audio id="start_sound" src="sound/start.mp3" preload="auto"></audio>
<audio id="run_sound" src="sound/run.mp3" preload="auto"></audio>

<div class="col-xs-4 col-md-4">
	<div id="container_download" style="min-width: 310px; max-width: 400px; height: 300px; margin: 0 auto"></div>
	<div id="dlspeed" style="text-align: center; color: red;" >  </div>
</div>

<div class="col-xs-4 col-md-4">
	<div id="container_upload" style="min-width: 310px; max-width: 400px; height: 300px; margin: 0 auto"></div>
	<div id="ulspeed" style="text-align: center; color: red;" >  </div>
</div>


  <div class="col-xs-12 col-md-12"> 

	<br>
	<button type="button" class="btn btn-default" id="start_test"  >Start Test</button>
	
	
	<div id="ping_info" >
	</div>
  
  </div>
</div>

<br>
<div class="row" id="testtips" >
  <div class="col-xs-12 col-md-12"> 
	
	<h3>Test Tips</h3>
	<p>
	Test your Internet connection speed free of costs, by simply click on the start test button. 
	The Internet speed is affected by other softwares that you have installed on your computer or device. 
	Is recommended that you close other programs that can use Internet, before test your internet speed. 
	If not exist more softwares that consuming your internet speed, you will get a more accurate results; 
	otherwise you will get only your current available and unused internet bandwidth. 
	Please update your web browser to a new version if you get any error while testing your internet speed.
	</p>
	</div>
</div>


<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- MovBig -->
<ins class="adsbygoogle"
     style="display:inline-block;width:300px;height:250px"
     data-ad-client="ca-pub-1432664808275238"
     data-ad-slot="2697165906"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>


<div class="row" id="howitworks" >
	<div class="col-xs-12 col-md-12"> 
	<h3>How It Works</h3>
	
	<p>
	Every time you initialize the test by a click on the "Start Test" button, a ping tests is done to detect the fast servers depending on response time. 
	After select the server with the most small ping time, then the internet speed test is initialized, and a set of files are downloaded and uploaded 
	from your computer or device. 
	The final download speed is measured as the average of all the independent download speed tests done.
	
	</p>
	</div>
</div>


<div class="row" id="androidapp" >
	<div class="col-xs-12 col-md-12"> 
	<h3>Android App</h3>
	
	<p>
	You can also perform the internet speed test on your android device free of costs, and measure how fast can be internet on your mobile device. <a href="https://play.google.com/store/apps/details?id=com.wInternetSpeedTestFree" >Download the app here</a> 
	from google app store or just scan the QR code using your mobile QR code scanner.
To start the test on your mobile device, locate the “Start Test” button and click it.
	</p>

<img src="qrcode.png" alt="Internet Speed Test, free app QR code.">
	</div>
</div>


<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- MovBig -->
<ins class="adsbygoogle"
     style="display:inline-block;width:300px;height:250px"
     data-ad-client="ca-pub-1432664808275238"
     data-ad-slot="2697165906"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>


<div class="row" id="terms" >
	<div class="col-xs-12 col-md-12"> 
	<h3> Terms &amp; Conditions</h3>
	
	<p>
	You can use all our services free to test your internet speed free of costs.
	</p>
	</div>
</div>

<br>


<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- MovBig -->
<ins class="adsbygoogle"
     style="display:inline-block;width:300px;height:250px"
     data-ad-client="ca-pub-1432664808275238"
     data-ad-slot="2697165906"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>


<ul>
<li></li>
<li></li>
<li></li>
<li></li>
</ul>


<footer>
    <div class="navbar navbar-inverse navbar-fixed-bottom">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" style="float: left;"  data-toggle="collapse" data-target="#footer-body">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>    
            </div>
            <div class="navbar-collapse collapse" id="footer-body">
                <ul class="nav navbar-nav">
						  <li><a href="#starttest">Start Test</a></li>                    
                    <li><a href="#testtips">Test Tips</a></li>
                    <li><a href="#howitworks">How It Works</a></li>
                    <li> <a href="#androidapp" >Android App</a> </li>
                    <li><a href="#terms">Terms &amp; Conditions</a></li>
                </ul>
            </div>
        </div>
    </div>
</footer>


</div>



<script type="text/javascript">

var chart_upload = null;
var chart_download = null;
var max_sp = 100;

var max_detected_download = 0;
var max_detected_upload = 0;

function update_chart(newVal, is_download) {

	chart = null;
	max_detected = 0;
	change_done = false;
	
	if(is_download){
		chart = chart_download;
		max_detected = max_detected_download;
		if(newVal>max_detected){
			max_detected = newVal + 5;
			max_detected_download = max_detected;
			change_done = true;
		}
	}else{
		chart = chart_upload;
		max_detected = max_detected_upload;
		if(newVal>max_detected){
			max_detected = newVal + 5;
			max_detected_upload = max_detected;
			change_done = true;
		}
	}

   if( change_done && max_detected < max_sp){
   	chart.yAxis[0].setExtremes(0, Math.round(max_detected), true);
   	
	}

	var point = chart.series[0].points[0];
   point.update(newVal);


}


$(function () {

//DOWLOAD CHART
    $('#container_download').highcharts({

        chart: {
            type: 'gauge',
            plotBackgroundColor: null,
            plotBackgroundImage: null,
            plotBorderWidth: 0,
            plotShadow: false
        },

        title: {
            text: 'Download Speedometer'
        },

        pane: {
            startAngle: -150,
            endAngle: 150,
            background: [{
                backgroundColor: {
                    linearGradient: { x1: 0, y1: 0, x2: 0, y2: 1 },
                    stops: [
                        [0, '#FFF'],
                        [1, '#333']
                    ]
                },
                borderWidth: 0,
                outerRadius: '109%'
            }, {
                backgroundColor: {
                    linearGradient: { x1: 0, y1: 0, x2: 0, y2: 1 },
                    stops: [
                        [0, '#333'],
                        [1, '#FFF']
                    ]
                },
                borderWidth: 1,
                outerRadius: '107%'
            }, {
                // default background
            }, {
                backgroundColor: '#DDD',
                borderWidth: 0,
                outerRadius: '105%',
                innerRadius: '103%'
            }]
        },

        // the value axis
        yAxis: {
            min: 0,
            max: 100,

            minorTickInterval: 'auto',
            minorTickWidth: 1,
            minorTickLength: 10,
            minorTickPosition: 'inside',
            minorTickColor: '#666',

            tickPixelInterval: 30,
            tickWidth: 2,
            tickPosition: 'inside',
            tickLength: 10,
            tickColor: '#666',
            labels: {
                step: 2,
                rotation: 'auto'
            },
            title: {
                text: 'Mb/s'
            },
            plotBands: [{
                from: 0,
                to: 75,
                color: '#55BF3B' // green
            }, {
                from: 75,
                to: 100,
                color: '#DDDF0D' // yellow
            }]
        },

        series: [{
            name: 'Speed',
            data: [0],
            tooltip: {
                valueSuffix: ' Mb/s'
            }
        }]

    },
        // Add some life
        function (chart) {
            if (!chart.renderer.forExport) {
					chart_download = chart;
            }
        });


//UPLOAD CHART
    $('#container_upload').highcharts({

        chart: {
            type: 'gauge',
            plotBackgroundColor: null,
            plotBackgroundImage: null,
            plotBorderWidth: 0,
            plotShadow: false
        },

        title: {
            text: 'Upload Speedometer'
        },

        pane: {
            startAngle: -150,
            endAngle: 150,
            background: [{
                backgroundColor: {
                    linearGradient: { x1: 0, y1: 0, x2: 0, y2: 1 },
                    stops: [
                        [0, '#FFF'],
                        [1, '#333']
                    ]
                },
                borderWidth: 0,
                outerRadius: '109%'
            }, {
                backgroundColor: {
                    linearGradient: { x1: 0, y1: 0, x2: 0, y2: 1 },
                    stops: [
                        [0, '#333'],
                        [1, '#FFF']
                    ]
                },
                borderWidth: 1,
                outerRadius: '107%'
            }, {
                // default background
            }, {
                backgroundColor: '#DDD',
                borderWidth: 0,
                outerRadius: '105%',
                innerRadius: '103%'
            }]
        },

        // the value axis
        yAxis: {
            min: 0,
            max: 100,

            minorTickInterval: 'auto',
            minorTickWidth: 1,
            minorTickLength: 10,
            minorTickPosition: 'inside',
            minorTickColor: '#666',

            tickPixelInterval: 30,
            tickWidth: 2,
            tickPosition: 'inside',
            tickLength: 10,
            tickColor: '#666',
            labels: {
                step: 2,
                rotation: 'auto'
            },
            title: {
                text: 'Mb/s'
            },
            plotBands: [{
                from: 0,
                to: 75,
                color: '#55BF3B' // green
            }, {
                from: 75,
                to: 100,
                color: '#DDDF0D' // yellow
            }]
        },

        series: [{
            name: 'Speed',
            data: [0],
            tooltip: {
                valueSuffix: ' Mb/s'
            }
        }]

    },
        // Add some life
        function (chart) {
            if (!chart.renderer.forExport) {
					chart_upload = chart;
            }
        });

});	

</script>



</body>
</html>
